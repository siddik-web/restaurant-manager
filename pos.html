<!DOCTYPE html>
<html lang="en" dir="ltr" class="bg-gray-50">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Restaurant Manager</title>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#0f766e',
                        secondary: '#f97316'
                    }
                }
            }
        }
    </script>
    <script src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
    <script src="app.js"></script>
   
</head>
<body x-data="app()" x-init="initApp()" :dir="direction" :class="{'rtl': direction === 'rtl'}">
    <!-- App Header -->
    <header class="bg-primary text-white shadow-md">
        <div class="container mx-auto px-4 py-3 flex justify-between items-center">
            <h1 class="text-xl font-bold flex items-center gap-2">
                <i class="fas fa-utensils"></i>
                <span x-text="translations.appTitle"></span>
            </h1>
            
            <div class="flex items-center gap-4">
                <!-- Language Switcher -->
                <div class="flex gap-2">
                    <button @click="changeLanguage('en')" 
                            class="px-3 py-1 rounded-md"
                            :class="{'bg-white text-primary': language === 'en'}">
                        EN
                    </button>
                    <button @click="changeLanguage('ar')" 
                            class="px-3 py-1 rounded-md"
                            :class="{'bg-white text-primary': language === 'ar'}">
                        AR
                    </button>
                </div>
                
                <!-- Navigation -->
                <nav class="flex gap-4">
                    <button @click="currentTab = 'pos'" 
                            class="px-3 py-1 rounded-md hover:bg-white hover:text-primary transition"
                            :class="{'bg-white text-primary': currentTab === 'pos'}">
                        <i class="fas fa-cash-register mr-2"></i>
                        <span x-text="translations.pos"></span>
                    </button>
                    <button @click="currentTab = 'kds'" 
                            class="px-3 py-1 rounded-md hover:bg-white hover:text-primary transition"
                            :class="{'bg-white text-primary': currentTab === 'kds'}">
                        <i class="fas fa-tv mr-2"></i>
                        <span x-text="translations.kds"></span>
                    </button>
                    <button @click="currentTab = 'recipes'" 
                            class="px-3 py-1 rounded-md hover:bg-white hover:text-primary transition"
                            :class="{'bg-white text-primary': currentTab === 'recipes'}">
                        <i class="fas fa-book mr-2"></i>
                        <span x-text="translations.recipes"></span>
                    </button>
                    <button @click="currentTab = 'tables'" 
                            class="px-3 py-1 rounded-md hover:bg-white hover:text-primary transition"
                            :class="{'bg-white text-primary': currentTab === 'tables'}">
                        <i class="fas fa-chair mr-2"></i>
                        <span x-text="translations.tables"></span>
                    </button>
                    <button @click="currentTab = 'reports'; generateReports()" 
                            class="px-3 py-1 rounded-md hover:bg-white hover:text-primary transition"
                            :class="{'bg-white text-primary': currentTab === 'reports'}">
                        <i class="fas fa-chart-bar mr-2"></i>
                        <span x-text="translations.reports"></span>
                    </button>
                </nav>
                
                <!-- Settings & Backup Buttons -->
                <div class="flex gap-2">
                    <button @click="showBackup = true" 
                            class="px-3 py-1 rounded-md hover:bg-white hover:text-primary transition">
                        <i class="fas fa-database"></i>
                    </button>
                    <button @click="showSettings = true" 
                            class="px-3 py-1 rounded-md hover:bg-white hover:text-primary transition">
                        <i class="fas fa-cog"></i>
                    </button>
                </div>
            </div>
        </div>
    </header>

    <main class="container mx-auto px-4 py-6">
        <!-- POS System -->
        <div x-show="currentTab === 'pos'" class="bg-white rounded-lg shadow-lg p-6">
            <h2 class="text-2xl font-bold mb-6 text-primary flex items-center gap-2">
                <i class="fas fa-cash-register"></i>
                <span x-text="translations.pos"></span>
            </h2>
            
            <div class="grid grid-cols-1 lg:grid-cols-4 gap-6">
                <!-- Menu Items Section -->
                <div class="lg:col-span-3">
                    <!-- Advanced Search and Filters -->
                    <div class="bg-gray-50 rounded-lg p-4 mb-6">
                        <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-4">
                            <!-- Search Bar -->
                            <div class="md:col-span-2">
                                <div class="relative">
                                    <input type="text" x-model="posSearchTerm" placeholder="Search items by name, category, or tags..."
                                           class="w-full border rounded-lg pl-10 pr-4 py-2 focus:ring-2 focus:ring-primary focus:border-transparent">
                                    <i class="fas fa-search absolute left-3 top-3 text-gray-400"></i>
                                </div>
                            </div>
                            
                            <!-- Category Filter -->
                            <div>
                                <select x-model="posFilterCategory" class="w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary focus:border-transparent">
                                    <option value="all">All Categories</option>
                                    <template x-for="category in recipeCategories" :key="category">
                                        <option :value="category" x-text="category"></option>
                                    </template>
                                </select>
                            </div>
                            
                            <!-- Sort Options -->
                            <div>
                                <select x-model="posSortBy" class="w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary focus:border-transparent">
                                    <option value="name">Sort by Name</option>
                                    <option value="price">Sort by Price</option>
                                    <option value="popularity">Sort by Popularity</option>
                                    <option value="category">Sort by Category</option>
                                </select>
                            </div>
                        </div>
                        
                        <!-- Quick Filters -->
                        <div class="flex flex-wrap gap-2">
                            <button @click="posQuickFilter = 'all'" 
                                    class="px-3 py-1 rounded-full text-sm border transition"
                                    :class="{'bg-primary text-white border-primary': posQuickFilter === 'all', 'bg-white text-gray-600 border-gray-300 hover:bg-gray-50': posQuickFilter !== 'all'}">
                                All Items
                            </button>
                            <button @click="posQuickFilter = 'popular'" 
                                    class="px-3 py-1 rounded-full text-sm border transition"
                                    :class="{'bg-primary text-white border-primary': posQuickFilter === 'popular', 'bg-white text-gray-600 border-gray-300 hover:bg-gray-50': posQuickFilter !== 'popular'}">
                                <i class="fas fa-fire mr-1"></i>Popular
                            </button>
                            <button @click="posQuickFilter = 'vegetarian'" 
                                    class="px-3 py-1 rounded-full text-sm border transition"
                                    :class="{'bg-primary text-white border-primary': posQuickFilter === 'vegetarian', 'bg-white text-gray-600 border-gray-300 hover:bg-gray-50': posQuickFilter !== 'vegetarian'}">
                                <i class="fas fa-leaf mr-1"></i>Vegetarian
                            </button>
                            <button @click="posQuickFilter = 'spicy'" 
                                    class="px-3 py-1 rounded-full text-sm border transition"
                                    :class="{'bg-primary text-white border-primary': posQuickFilter === 'spicy', 'bg-white text-gray-600 border-gray-300 hover:bg-gray-50': posQuickFilter !== 'spicy'}">
                                <i class="fas fa-pepper-hot mr-1"></i>Spicy
                            </button>
                            <button @click="posQuickFilter = 'healthy'" 
                                    class="px-3 py-1 rounded-full text-sm border transition"
                                    :class="{'bg-primary text-white border-primary': posQuickFilter === 'healthy', 'bg-white text-gray-600 border-gray-300 hover:bg-gray-50': posQuickFilter !== 'healthy'}">
                                <i class="fas fa-heart mr-1"></i>Healthy
                            </button>
                        </div>
                    </div>
                    
                    <!-- Category Tabs -->
                    <div class="mb-6">
                        <div class="flex flex-wrap gap-2 border-b">
                            <button @click="posActiveCategory = 'all'" 
                                    class="px-4 py-2 rounded-t-lg font-medium transition"
                                    :class="{'bg-primary text-white': posActiveCategory === 'all', 'bg-gray-100 text-gray-700 hover:bg-gray-200': posActiveCategory !== 'all'}">
                                All
                            </button>
                            <template x-for="category in recipeCategories" :key="category">
                                <button @click="posActiveCategory = category" 
                                        class="px-4 py-2 rounded-t-lg font-medium transition"
                                        :class="{'bg-primary text-white': posActiveCategory === category, 'bg-gray-100 text-gray-700 hover:bg-gray-200': posActiveCategory !== category}">
                                    <span x-text="category"></span>
                                    <span class="ml-2 bg-white bg-opacity-20 px-2 py-0.5 rounded-full text-xs" 
                                          x-text="getFilteredRecipes().filter(r => r.category === category).length"></span>
                            </button>
                        </template>
                        </div>
                    </div>
                    
                    <!-- Menu Items Grid -->
                    <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 mb-6">
                        <template x-for="recipe in getFilteredRecipes()" :key="recipe.id">
                            <div class="bg-white border border-gray-200 rounded-lg p-4 hover:shadow-lg transition-all duration-200 cursor-pointer group relative overflow-hidden"
                                 @click="addToOrder(recipe)">
                                <!-- Recipe Image Placeholder -->
                                <div class="w-full h-32 bg-gradient-to-br from-gray-100 to-gray-200 rounded-lg mb-3 flex items-center justify-center">
                                    <i class="fas fa-utensils text-3xl text-gray-400 group-hover:text-primary transition-colors"></i>
                                </div>
                                
                                <!-- Recipe Info -->
                                <div class="space-y-2">
                                    <div class="font-bold text-sm leading-tight" x-text="recipe.name"></div>
                                    <div class="text-primary font-bold text-lg" x-text="formatPrice(recipe.price)"></div>
                                    <div class="text-xs text-gray-500" x-text="recipe.category"></div>
                                    
                                    <!-- Tags -->
                                    <div x-show="recipe.tags && recipe.tags.length > 0" class="flex flex-wrap gap-1">
                                        <template x-for="tag in (recipe.tags || []).slice(0, 2)" :key="tag">
                                            <span class="inline-block bg-blue-100 text-blue-800 text-xs px-2 py-0.5 rounded" x-text="tag"></span>
                                        </template>
                                        <span x-show="(recipe.tags || []).length > 2" class="text-xs text-gray-400">+<span x-text="(recipe.tags || []).length - 2"></span></span>
                                    </div>
                                    
                                    <!-- Quick Info -->
                                    <div class="flex justify-between text-xs text-gray-500">
                                        <span x-text="recipe.prepTime + 'm prep'"></span>
                                        <span x-text="recipe.difficulty"></span>
                                    </div>
                                </div>
                                
                                <!-- Add Button Overlay -->
                                <div class="absolute inset-0 bg-primary bg-opacity-90 rounded-lg flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none">
                                    <div class="text-white text-center">
                                        <i class="fas fa-plus text-2xl mb-2"></i>
                                        <div class="font-bold text-sm">Add to Order</div>
                                    </div>
                                </div>
                            </div>
                        </template>
                        
                        <!-- Empty State -->
                        <template x-if="getFilteredRecipes().length === 0">
                            <div class="col-span-full text-center py-12">
                                <i class="fas fa-search text-4xl text-gray-300 mb-4"></i>
                                <h3 class="text-lg font-medium text-gray-500 mb-2">No items found</h3>
                                <p class="text-gray-400">Try adjusting your search or filters</p>
                            </div>
                        </template>
                    </div>
                    
                    <!-- Order Type and Table Selection -->
                    <div class="bg-gray-50 p-4 rounded-lg mb-6">
                        <h3 class="font-bold mb-3" x-text="translations.orderType"></h3>
                        <div class="flex gap-4 mb-4">
                            <button @click="orderType = 'dine-in'; currentOrder.tableNumber = null" 
                                    class="px-4 py-2 rounded-lg border transition-all duration-200"
                                    :class="{'bg-primary text-white border-primary shadow-md': orderType === 'dine-in', 'bg-white border-gray-300 hover:bg-gray-50': orderType !== 'dine-in'}">
                                <i class="fas fa-utensils mr-2"></i>
                                <span x-text="translations.dineIn"></span>
                            </button>
                            <button @click="orderType = 'takeaway'; currentOrder.tableNumber = null" 
                                    class="px-4 py-2 rounded-lg border transition-all duration-200"
                                    :class="{'bg-primary text-white border-primary shadow-md': orderType === 'takeaway', 'bg-white border-gray-300 hover:bg-gray-50': orderType !== 'takeaway'}">
                                <i class="fas fa-box mr-2"></i>
                                <span x-text="translations.takeaway"></span>
                            </button>
                            <button @click="orderType = 'delivery'; currentOrder.tableNumber = null" 
                                    class="px-4 py-2 rounded-lg border transition-all duration-200"
                                    :class="{'bg-primary text-white border-primary shadow-md': orderType === 'delivery', 'bg-white border-gray-300 hover:bg-gray-50': orderType !== 'delivery'}">
                                <i class="fas fa-truck mr-2"></i>
                                <span x-text="translations.delivery"></span>
                            </button>
                        </div>
                        
                        <!-- Table Selection for Dine-in -->
                        <div x-show="orderType === 'dine-in'" class="mt-4">
                            <h4 class="font-bold mb-2" x-text="translations.selectTable"></h4>
                            <div class="grid grid-cols-4 md:grid-cols-6 gap-2">
                                <template x-for="table in tables" :key="table.id">
                                    <button @click="selectTable(table.number)"
                                            class="p-3 rounded-lg border text-center transition-all duration-200 relative"
                                            :class="{
                                                'bg-primary text-white border-primary shadow-md': currentOrder.tableNumber === table.number,
                                                'bg-white border-gray-300 hover:bg-gray-50': currentOrder.tableNumber !== table.number,
                                                'opacity-50 cursor-not-allowed': table.status === 'occupied'
                                            }"
                                            :disabled="table.status === 'occupied'">
                                        <div class="font-bold" x-text="'Table ' + table.number"></div>
                                        <div class="text-xs" x-text="table.capacity + ' seats'"></div>
                                        <div class="text-xs mt-1 px-2 py-1 rounded-full" 
                                             :class="getTableStatusColor(table.status)"
                                             x-text="translations[table.status]"></div>
                                        
                                        <!-- Status Indicator -->
                                        <div class="absolute top-1 right-1 w-2 h-2 rounded-full"
                                             :class="{
                                                 'bg-green-500': table.status === 'available',
                                                 'bg-yellow-500': table.status === 'reserved',
                                                 'bg-red-500': table.status === 'occupied',
                                                 'bg-blue-500': table.status === 'cleaning',
                                                 'bg-purple-500': table.status === 'maintenance'
                                             }"></div>
                                    </button>
                                </template>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Current Order Panel -->
                <div class="lg:col-span-1">
                    <div class="bg-gray-50 rounded-lg p-6 sticky top-6">
                        <div class="flex justify-between items-center mb-4">
                            <h3 class="font-bold text-lg" x-text="translations.currentOrder"></h3>
                            <button @click="clearCurrentOrder()" 
                                    class="text-red-500 hover:text-red-700 transition"
                                    x-show="currentOrder.items.length > 0">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                        
                        <!-- Order Items -->
                        <div class="mb-4 max-h-96 overflow-y-auto">
                            <div class="flex justify-between font-bold mb-2 text-sm text-gray-600">
                            <span x-text="translations.item"></span>
                            <span x-text="translations.total"></span>
                        </div>
                        
                            <div class="space-y-2">
                            <template x-for="(item, index) in currentOrder.items" :key="index">
                                    <div class="bg-white rounded-lg p-3 shadow-sm">
                                        <div class="flex justify-between items-start mb-2">
                                            <div class="flex-1">
                                                <div class="font-medium text-sm" x-text="item.name"></div>
                                                <div class="text-xs text-gray-500" x-text="formatPrice(item.price) + ' each'"></div>
                                    </div>
                                            <div class="text-right">
                                                <div class="font-bold text-sm" x-text="formatPrice(item.price * item.quantity)"></div>
                                            </div>
                                        </div>
                                        
                                        <div class="flex items-center justify-between">
                                    <div class="flex items-center gap-2">
                                        <button @click="updateItemQuantity(index, item.quantity - 1)"
                                                        class="w-6 h-6 rounded-full bg-gray-200 flex items-center justify-center hover:bg-gray-300 transition"
                                                        :disabled="item.quantity <= 1">
                                            <i class="fas fa-minus text-xs"></i>
                                        </button>
                                                <span class="font-bold text-sm w-8 text-center" x-text="item.quantity"></span>
                                        <button @click="updateItemQuantity(index, item.quantity + 1)"
                                                        class="w-6 h-6 rounded-full bg-gray-200 flex items-center justify-center hover:bg-gray-300 transition">
                                            <i class="fas fa-plus text-xs"></i>
                                        </button>
                                            </div>
                                            <button @click="removeItem(index)" class="text-red-500 hover:text-red-700 transition">
                                                <i class="fas fa-trash text-sm"></i>
                                        </button>
                                    </div>
                                </div>
                            </template>
                            
                            <template x-if="currentOrder.items.length === 0">
                                    <div class="text-center py-8 text-gray-500">
                                        <i class="fas fa-shopping-cart text-3xl mb-2"></i>
                                        <p class="text-sm" x-text="translations.emptyOrder"></p>
                                    </div>
                            </template>
                        </div>
                    </div>
                    
                        <!-- Order Summary -->
                        <div class="border-t pt-4 space-y-2">
                            <div class="flex justify-between text-sm">
                            <span x-text="translations.subtotal"></span>
                            <span x-text="formatPrice(currentOrder.subtotal)"></span>
                        </div>
                            <div class="flex justify-between text-sm">
                                <span x-text="translations.tax + ' (' + settings.taxRate + '%)'"></span>
                            <span x-text="formatPrice(currentOrder.tax)"></span>
                        </div>
                            <div x-show="orderType === 'delivery'" class="flex justify-between text-sm">
                                <span x-text="translations.deliveryFee"></span>
                                <span x-text="formatPrice(currentOrder.deliveryFee)"></span>
                            </div>
                            <div class="flex justify-between font-bold text-lg pt-2 border-t">
                            <span x-text="translations.total"></span>
                            <span x-text="formatPrice(currentOrder.total)"></span>
                        </div>
                    </div>
                    
                        <!-- Order Info -->
                        <div class="mt-4 p-3 bg-white rounded-lg border">
                            <div class="text-sm space-y-1">
                                <div class="flex justify-between">
                                    <span class="text-gray-600" x-text="translations.orderType"></span>
                                    <span class="font-medium" x-text="translations[orderType]"></span>
                                </div>
                                <div x-show="orderType === 'dine-in' && currentOrder.tableNumber" class="flex justify-between">
                                    <span class="text-gray-600" x-text="translations.tableNumber"></span>
                                    <span class="font-medium" x-text="'Table ' + currentOrder.tableNumber"></span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-gray-600">Items</span>
                                    <span class="font-medium" x-text="currentOrder.items.length"></span>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Action Buttons -->
                        <div class="mt-6 space-y-3">
                    <button @click="placeOrder()" 
                            :disabled="currentOrder.items.length === 0"
                                    class="w-full bg-primary text-white py-3 rounded-lg font-bold hover:bg-teal-700 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed shadow-md hover:shadow-lg"
                            x-text="translations.placeOrder">
                            </button>
                            
                            <div class="grid grid-cols-2 gap-2">
                                <button @click="generateReceipt(currentOrder)" 
                                        :disabled="currentOrder.items.length === 0"
                                        class="bg-blue-500 text-white py-2 rounded-lg text-sm hover:bg-blue-600 transition disabled:opacity-50">
                                    <i class="fas fa-print mr-1"></i>Preview
                                </button>
                                <button @click="saveOrderAsDraft()" 
                                        :disabled="currentOrder.items.length === 0"
                                        class="bg-gray-500 text-white py-2 rounded-lg text-sm hover:bg-gray-600 transition disabled:opacity-50">
                                    <i class="fas fa-save mr-1"></i>Save Draft
                    </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Enhanced Kitchen Display System -->
        <div x-show="currentTab === 'kds'" class="bg-white rounded-lg shadow-lg p-6">
            <!-- KDS Header with Controls -->
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-2xl font-bold text-primary flex items-center gap-2">
                <i class="fas fa-tv"></i>
                <span x-text="translations.kds"></span>
            </h2>
                
                <div class="flex gap-2">
                    <!-- KDS Controls -->
                    <div class="flex gap-2">
                        <select x-model="kdsView" class="border rounded-lg px-3 py-1 text-sm">
                            <option value="all" x-text="'All Orders'"></option>
                            <option value="new" x-text="translations.newOrders"></option>
                            <option value="preparing" x-text="translations.preparing"></option>
                            <option value="ready" x-text="translations.ready"></option>
                        </select>
                        
                        <select x-model="kdsFilter" class="border rounded-lg px-3 py-1 text-sm">
                            <option value="all" x-text="'All Types'"></option>
                            <option value="dine-in" x-text="translations.dineIn"></option>
                            <option value="takeaway" x-text="translations.takeaway"></option>
                            <option value="delivery" x-text="translations.delivery"></option>
                        </select>
                        
                        <select x-model="kdsSort" class="border rounded-lg px-3 py-1 text-sm">
                            <option value="time" x-text="'By Time'"></option>
                            <option value="priority" x-text="'By Priority'"></option>
                            <option value="table" x-text="'By Table'"></option>
                        </select>
                        <!-- Station Filter -->
                        <select x-model="kdsStationFilter" class="border rounded-lg px-3 py-1 text-sm">
                            <option value="all">All Stations</option>
                            <template x-for="station in stations" :key="station.name">
                                <option :value="station.name" x-text="station.name"></option>
                            </template>
                        </select>
                    </div>
                    
                    <button @click="showKdsSettings = true" 
                            class="bg-gray-500 text-white px-3 py-1 rounded-lg text-sm hover:bg-gray-600 transition">
                        <i class="fas fa-cog"></i>
                    </button>
                    <button @click="showChefStationManager = true"
                            class="bg-primary text-white px-3 py-1 rounded-lg text-sm hover:bg-teal-700 transition">
                        <i class="fas fa-users-cog"></i>
                        <span class="hidden md:inline" x-text="translations.kdsManageChefs"></span>
                    </button>
                </div>
            </div>
            
            <!-- Kitchen Statistics -->
            <div class="grid grid-cols-2 md:grid-cols-5 gap-4 mb-6">
                <div class="bg-blue-50 border border-blue-200 rounded-lg p-3 text-center">
                    <div class="text-2xl font-bold text-blue-600" x-text="getKitchenStats().totalOrders"></div>
                    <div class="text-sm text-blue-800" x-text="'Total Orders'"></div>
                </div>
                <div class="bg-green-50 border border-green-200 rounded-lg p-3 text-center">
                    <div class="text-2xl font-bold text-green-600" x-text="getKitchenStats().completedOrders"></div>
                    <div class="text-sm text-green-800" x-text="'Completed'"></div>
                </div>
                <div class="bg-orange-50 border border-orange-200 rounded-lg p-3 text-center">
                    <div class="text-2xl font-bold text-orange-600" x-text="getKitchenStats().pendingOrders"></div>
                    <div class="text-sm text-orange-800" x-text="'Pending'"></div>
                </div>
                <div class="bg-purple-50 border border-purple-200 rounded-lg p-3 text-center">
                    <div class="text-2xl font-bold text-purple-600" x-text="getKitchenStats().avgPrepTime + 'm'"></div>
                    <div class="text-sm text-purple-800" x-text="'Avg Prep Time'"></div>
                </div>
                <div class="bg-teal-50 border border-teal-200 rounded-lg p-3 text-center">
                    <div class="text-2xl font-bold text-teal-600" x-text="getKitchenStats().efficiency + '%'"></div>
                    <div class="text-sm text-teal-800" x-text="'Efficiency'"></div>
                </div>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <!-- New Orders -->
                <div>
                    <h3 class="text-lg font-bold mb-4 text-center bg-blue-100 py-2 rounded">
                        <i class="fas fa-bell mr-2"></i>
                        <span x-text="translations.newOrders"></span>
                        <span class="ml-2 bg-blue-500 text-white px-2 py-1 rounded-full text-xs" 
                              x-text="getFilteredOrders().filter(o => o.status === 'new').length"></span>
                    </h3>
                    
                    <div class="space-y-4 max-h-96 overflow-y-auto">
                        <template x-for="order in getFilteredOrders()" :key="order.id">
                            <template x-if="order.status === 'new'">
                                <div class="bg-white border rounded-lg p-4 shadow-lg" 
                                     :class="getOrderStatusColor(order)">
                                    <!-- Order Header -->
                                    <div class="flex justify-between items-start mb-3">
                                        <div>
                                            <div class="flex items-center gap-2">
                                                <div class="font-bold text-lg" x-text="'#' + order.id"></div>
                                                <div x-show="order.urgent" class="bg-red-500 text-white px-2 py-1 rounded-full text-xs animate-pulse">
                                                    <i class="fas fa-exclamation-triangle mr-1"></i>
                                                    <span x-text="translations.kdsUrgent"></span>
                                                </div>
                                            </div>
                                            <div class="text-sm" x-text="formatDateTime(order.timestamp)"></div>
                                            <div x-show="order.tableNumber" class="text-xs" x-text="'Table ' + order.tableNumber"></div>
                                            <div class="text-xs font-bold" x-text="'Age: ' + getOrderAgeText(order)"></div>
                                        </div>
                                        <div class="text-right">
                                            <div class="px-2 py-1 rounded-full text-xs mb-1" 
                                                 :class="{
                                                     'bg-blue-100 text-blue-800': order.type === 'dine-in',
                                                     'bg-green-100 text-green-800': order.type === 'takeaway',
                                                     'bg-red-100 text-red-800': order.type === 'delivery'
                                                 }"
                                                 x-text="translations[order.type]"></div>
                                            <div class="text-xs" x-text="'Est: ' + getEstimatedPrepTime(order) + 'm'"></div>
                                        </div>
                                    </div>
                                    
                                    <!-- Order Items -->
                                    <div class="border-t pt-3 mb-3">
                                        <template x-for="item in order.items" :key="item.id">
                                            <div class="flex justify-between text-sm py-1">
                                                <div class="flex items-center">
                                                    <span class="font-bold mr-2" x-text="item.quantity + '×'"></span>
                                                    <span x-text="item.name"></span>
                                                </div>
                                                <div class="text-xs text-gray-600" x-text="formatPrice(item.price * item.quantity)"></div>
                                            </div>
                                        </template>
                                    </div>
                                    
                                    <!-- Order Actions -->
                                    <div class="flex justify-between items-center">
                                        <div class="text-xs">
                                            <span x-text="'Priority: ' + getOrderPriority(order)"></span>
                                        </div>
                                        <div class="flex gap-2">
                                            <button @click="generateReceipt(order)"
                                                    class="bg-blue-500 text-white px-3 py-1 rounded text-xs hover:bg-blue-600 transition">
                                                <i class="fas fa-print"></i>
                                            </button>
                                        <button @click="updateOrderStatus(order.id, 'preparing')"
                                                    class="bg-green-500 text-white px-3 py-1 rounded text-xs hover:bg-green-600 transition">
                                            <i class="fas fa-play mr-1"></i>
                                            <span x-text="translations.startPreparing"></span>
                                        </button>
                                    </div>
                                    </div>
                                    
                                    <!-- Assigned Chef/Station -->
                                    <div class="flex items-center gap-2 mt-2">
                                        <template x-if="order.assignedChef">
                                            <div class="bg-gray-100 px-2 py-1 rounded text-xs flex items-center gap-1">
                                                <i class="fas fa-user-tie text-primary"></i>
                                                <span x-text="translations.kdsAssignedTo + ': ' + order.assignedChef"></span>
                                                <span x-show="order.assignedStation">| <span x-text="order.assignedStation"></span></span>
                                                <button @click="unassignOrderChefStation(order.id)" class="ml-2 text-red-500 hover:text-red-700" title="Unassign">
                                                    <i class="fas fa-times"></i>
                                                </button>
                                            </div>
                                        </template>
                                        <template x-if="!order.assignedChef">
                                            <button @click="showChefAssignModal = true; chefAssignOrderId = order.id; chefAssignName = ''; chefAssignStation = '';" 
                                                    class="bg-primary text-white px-2 py-1 rounded text-xs hover:bg-teal-700 transition flex items-center gap-1">
                                                <i class="fas fa-user-plus"></i>
                                                <span x-text="translations.kdsAssignChef"></span>
                                            </button>
                                        </template>
                                    </div>
                                </div>
                            </template>
                        </template>
                        
                        <template x-if="getFilteredOrders().filter(o => o.status === 'new').length === 0">
                            <div class="text-center text-gray-500 py-8" x-text="translations.noNewOrders"></div>
                        </template>
                    </div>
                </div>
                
                <!-- Preparing Orders -->
                <div>
                    <h3 class="text-lg font-bold mb-4 text-center bg-orange-100 py-2 rounded">
                        <i class="fas fa-clock mr-2"></i>
                        <span x-text="translations.preparing"></span>
                        <span class="ml-2 bg-orange-500 text-white px-2 py-1 rounded-full text-xs" 
                              x-text="getFilteredOrders().filter(o => o.status === 'preparing').length"></span>
                    </h3>
                    
                    <div class="space-y-4 max-h-96 overflow-y-auto">
                        <template x-for="order in getFilteredOrders()" :key="order.id">
                            <template x-if="order.status === 'preparing'">
                                <div class="bg-white border rounded-lg p-4 shadow-lg" 
                                     :class="getOrderStatusColor(order)">
                                    <!-- Order Header -->
                                    <div class="flex justify-between items-start mb-3">
                                        <div>
                                            <div class="flex items-center gap-2">
                                                <div class="font-bold text-lg" x-text="'#' + order.id"></div>
                                                <div x-show="order.urgent" class="bg-red-500 text-white px-2 py-1 rounded-full text-xs animate-pulse">
                                                    <i class="fas fa-exclamation-triangle mr-1"></i>
                                                    <span x-text="translations.kdsUrgent"></span>
                                                </div>
                                            </div>
                                            <div class="text-sm" x-text="formatDateTime(order.timestamp)"></div>
                                            <div x-show="order.tableNumber" class="text-xs" x-text="'Table ' + order.tableNumber"></div>
                                            <div class="text-xs font-bold" x-text="'Age: ' + getOrderAgeText(order)"></div>
                                            <div class="text-xs" x-text="'Status: ' + translations[getPrepTimeStatus(order)]"></div>
                                            <!-- Progress Bar for Preparing Orders -->
                                            <div x-show="order.status === 'preparing'" class="mt-2">
                                                <div class="w-full bg-gray-200 rounded-full h-2">
                                                    <div class="bg-green-600 h-2 rounded-full transition-all duration-300" 
                                                         :style="'width: ' + getOrderPrepProgress(order.id) + '%'"></div>
                                        </div>
                                                <div class="text-xs text-gray-600 mt-1" x-text="'Progress: ' + Math.round(getOrderPrepProgress(order.id)) + '%'"></div>
                                            </div>
                                        </div>
                                        <div class="text-right">
                                            <div class="px-2 py-1 rounded-full text-xs mb-1" 
                                                 :class="{
                                                     'bg-blue-100 text-blue-800': order.type === 'dine-in',
                                                     'bg-green-100 text-green-800': order.type === 'takeaway',
                                                     'bg-red-100 text-red-800': order.type === 'delivery'
                                                 }"
                                                 x-text="translations[order.type]"></div>
                                            <div class="text-xs" x-text="'Est: ' + getEstimatedPrepTime(order) + 'm'"></div>
                                        </div>
                                    </div>
                                    
                                    <!-- Order Items -->
                                    <div class="border-t pt-3 mb-3">
                                        <template x-for="item in order.items" :key="item.id">
                                            <div class="flex justify-between text-sm py-1">
                                                <div class="flex items-center">
                                                    <span class="font-bold mr-2" x-text="item.quantity + '×'"></span>
                                                    <span x-text="item.name"></span>
                                                </div>
                                                <div class="text-xs text-gray-600" x-text="formatPrice(item.price * item.quantity)"></div>
                                            </div>
                                        </template>
                                    </div>
                                    
                                    <!-- Order Actions -->
                                    <div class="flex justify-between items-center">
                                        <div class="text-xs">
                                            <span x-text="'Time: ' + getOrderAgeText(order)"></span>
                                        </div>
                                        <div class="flex gap-2">
                                            <button @click="generateReceipt(order)"
                                                    class="bg-blue-500 text-white px-3 py-1 rounded text-xs hover:bg-blue-600 transition">
                                                <i class="fas fa-print"></i>
                                            </button>
                                        <button @click="updateOrderStatus(order.id, 'ready')"
                                                    class="bg-green-500 text-white px-3 py-1 rounded text-xs hover:bg-green-600 transition">
                                            <i class="fas fa-check mr-1"></i>
                                            <span x-text="translations.markReady"></span>
                                        </button>
                                    </div>
                                    </div>
                                    
                                    <!-- Assigned Chef/Station -->
                                    <div class="flex items-center gap-2 mt-2">
                                        <template x-if="order.assignedChef">
                                            <div class="bg-gray-100 px-2 py-1 rounded text-xs flex items-center gap-1">
                                                <i class="fas fa-user-tie text-primary"></i>
                                                <span x-text="translations.kdsAssignedTo + ': ' + order.assignedChef"></span>
                                                <span x-show="order.assignedStation">| <span x-text="order.assignedStation"></span></span>
                                                <button @click="unassignOrderChefStation(order.id)" class="ml-2 text-red-500 hover:text-red-700" title="Unassign">
                                                    <i class="fas fa-times"></i>
                                                </button>
                                            </div>
                                        </template>
                                        <template x-if="!order.assignedChef">
                                            <button @click="showChefAssignModal = true; chefAssignOrderId = order.id; chefAssignName = ''; chefAssignStation = '';" 
                                                    class="bg-primary text-white px-2 py-1 rounded text-xs hover:bg-teal-700 transition flex items-center gap-1">
                                                <i class="fas fa-user-plus"></i>
                                                <span x-text="translations.kdsAssignChef"></span>
                                            </button>
                                        </template>
                                    </div>
                                </div>
                            </template>
                        </template>
                        
                        <template x-if="getFilteredOrders().filter(o => o.status === 'preparing').length === 0">
                            <div class="text-center text-gray-500 py-8" x-text="translations.noPreparingOrders"></div>
                        </template>
                    </div>
                </div>
                
                <!-- Ready Orders -->
                <div>
                    <h3 class="text-lg font-bold mb-4 text-center bg-green-100 py-2 rounded">
                        <i class="fas fa-check-circle mr-2"></i>
                        <span x-text="translations.ready"></span>
                        <span class="ml-2 bg-green-500 text-white px-2 py-1 rounded-full text-xs" 
                              x-text="getFilteredOrders().filter(o => o.status === 'ready').length"></span>
                    </h3>
                    
                    <div class="space-y-4 max-h-96 overflow-y-auto">
                        <template x-for="order in getFilteredOrders()" :key="order.id">
                            <template x-if="order.status === 'ready'">
                                <div class="bg-white border rounded-lg p-4 shadow-lg" 
                                     :class="getOrderStatusColor(order)">
                                    <!-- Order Header -->
                                    <div class="flex justify-between items-start mb-3">
                                        <div>
                                            <div class="font-bold text-lg" x-text="'#' + order.id"></div>
                                            <div class="text-sm" x-text="formatDateTime(order.timestamp)"></div>
                                            <div x-show="order.tableNumber" class="text-xs" x-text="'Table ' + order.tableNumber"></div>
                                            <div class="text-xs font-bold" x-text="'Age: ' + getOrderAgeText(order)"></div>
                                        </div>
                                        <div class="text-right">
                                            <div class="px-2 py-1 rounded-full text-xs mb-1" 
                                                 :class="{
                                                     'bg-blue-100 text-blue-800': order.type === 'dine-in',
                                                     'bg-green-100 text-green-800': order.type === 'takeaway',
                                                     'bg-red-100 text-red-800': order.type === 'delivery'
                                                 }"
                                                 x-text="translations[order.type]"></div>
                                            <div class="text-xs" x-text="'Total: ' + formatPrice(order.total)"></div>
                                        </div>
                                    </div>
                                    
                                    <!-- Order Items -->
                                    <div class="border-t pt-3 mb-3">
                                        <template x-for="item in order.items" :key="item.id">
                                            <div class="flex justify-between text-sm py-1">
                                                <div class="flex items-center">
                                                    <span class="font-bold mr-2" x-text="item.quantity + '×'"></span>
                                                    <span x-text="item.name"></span>
                                                </div>
                                                <div class="text-xs text-gray-600" x-text="formatPrice(item.price * item.quantity)"></div>
                                            </div>
                                        </template>
                                    </div>
                                    
                                    <!-- Order Actions -->
                                    <div class="flex justify-between items-center">
                                        <div class="text-xs">
                                            <span x-text="'Ready: ' + getOrderAgeText(order)"></span>
                                        </div>
                                        <div class="flex gap-2">
                                            <button @click="generateReceipt(order)"
                                                    class="bg-blue-500 text-white px-3 py-1 rounded text-xs hover:bg-blue-600 transition">
                                                <i class="fas fa-print"></i>
                                            </button>
                                        <button @click="completeOrder(order.id)"
                                                    class="bg-gray-500 text-white px-3 py-1 rounded text-xs hover:bg-gray-600 transition">
                                            <i class="fas fa-times mr-1"></i>
                                            <span x-text="translations.complete"></span>
                                        </button>
                                    </div>
                                    </div>
                                    
                                    <!-- Assigned Chef/Station -->
                                    <div class="flex items-center gap-2 mt-2">
                                        <template x-if="order.assignedChef">
                                            <div class="bg-gray-100 px-2 py-1 rounded text-xs flex items-center gap-1">
                                                <i class="fas fa-user-tie text-primary"></i>
                                                <span x-text="translations.kdsAssignedTo + ': ' + order.assignedChef"></span>
                                                <span x-show="order.assignedStation">| <span x-text="order.assignedStation"></span></span>
                                                <button @click="unassignOrderChefStation(order.id)" class="ml-2 text-red-500 hover:text-red-700" title="Unassign">
                                                    <i class="fas fa-times"></i>
                                                </button>
                                            </div>
                                        </template>
                                        <template x-if="!order.assignedChef">
                                            <button @click="showChefAssignModal = true; chefAssignOrderId = order.id; chefAssignName = ''; chefAssignStation = '';" 
                                                    class="bg-primary text-white px-2 py-1 rounded text-xs hover:bg-teal-700 transition flex items-center gap-1">
                                                <i class="fas fa-user-plus"></i>
                                                <span x-text="translations.kdsAssignChef"></span>
                                            </button>
                                        </template>
                                    </div>
                                </div>
                            </template>
                        </template>
                        
                        <template x-if="getFilteredOrders().filter(o => o.status === 'ready').length === 0">
                            <div class="text-center text-gray-500 py-8" x-text="translations.noReadyOrders"></div>
                        </template>
                    </div>
                </div>
            </div>
        </div>

        <!-- Enhanced Recipe Management -->
        <div x-show="currentTab === 'recipes'" class="bg-white rounded-lg shadow-lg p-6">
            <h2 class="text-2xl font-bold mb-6 text-primary flex items-center gap-2">
                <i class="fas fa-book"></i>
                <span x-text="translations.recipes"></span>
            </h2>
            
            <!-- Recipe Controls -->
            <div class="flex flex-wrap gap-4 mb-6 p-4 bg-gray-50 rounded-lg">
                <div class="flex-1 min-w-64">
                    <input type="text" x-model="recipeSearchTerm" placeholder="Search recipes..."
                           class="w-full border rounded-lg px-3 py-2">
                </div>
                <select x-model="recipeFilterCategory" class="border rounded-lg px-3 py-2">
                    <option value="all">All Categories</option>
                    <template x-for="category in recipeCategories" :key="category">
                        <option :value="category" x-text="category"></option>
                    </template>
                </select>
                <select x-model="recipeSortBy" class="border rounded-lg px-3 py-2">
                    <option value="name">Sort by Name</option>
                    <option value="price">Sort by Price</option>
                    <option value="category">Sort by Category</option>
                    <option value="date">Sort by Date</option>
                </select>
                <button @click="recipeSortOrder = recipeSortOrder === 'asc' ? 'desc' : 'asc'"
                        class="border rounded-lg px-3 py-2 hover:bg-gray-100 transition">
                    <i class="fas" :class="recipeSortOrder === 'asc' ? 'fa-sort-up' : 'fa-sort-down'"></i>
                </button>
                <button @click="showRecipeForm = true; editingRecipe = null; resetRecipeForm()"
                        class="bg-primary text-white px-4 py-2 rounded-lg hover:bg-teal-700 transition">
                                <i class="fas fa-plus mr-1"></i>
                                <span x-text="translations.addRecipe"></span>
                            </button>
                        </div>
                        
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                <!-- Recipe List -->
                <div class="lg:col-span-1">
                    <div class="bg-gray-50 rounded-lg p-4">
                        <h3 class="font-bold mb-4" x-text="translations.recipeList"></h3>
                        
                        <div class="space-y-2 max-h-96 overflow-y-auto">
                            <template x-for="recipe in getFilteredRecipes()" :key="recipe.id">
                                <div class="bg-white border rounded-lg p-3 cursor-pointer hover:bg-gray-50 transition"
                                     @click="selectedRecipe = recipe; showRecipeForm = false">
                                    <div class="flex justify-between items-start mb-2">
                                        <div class="flex-1">
                                        <div class="font-bold" x-text="recipe.name"></div>
                                        <div class="text-sm text-gray-600" x-text="recipe.category"></div>
                                            <div class="text-sm font-bold text-primary" x-text="formatPrice(recipe.price)"></div>
                                    </div>
                                        <div class="flex gap-1" @click.stop>
                                            <button @click="duplicateRecipe(recipe)"
                                                    class="text-blue-500 hover:text-blue-700" title="Duplicate">
                                                <i class="fas fa-copy"></i>
                                            </button>
                                        <button @click="editRecipe(recipe)"
                                                    class="text-green-500 hover:text-green-700" title="Edit">
                                            <i class="fas fa-edit"></i>
                                        </button>
                                            <button @click="toggleRecipeActive(recipe.id)"
                                                    class="text-yellow-500 hover:text-yellow-700" title="Toggle Active">
                                                <i class="fas" :class="recipe.isActive ? 'fa-eye' : 'fa-eye-slash'"></i>
                                            </button>
                                        <button @click="deleteRecipe(recipe.id)"
                                                    class="text-red-500 hover:text-red-700" title="Delete">
                                            <i class="fas fa-trash"></i>
                                        </button>
                                        </div>
                                    </div>
                                    <div class="text-xs text-gray-500">
                                        <span x-text="'Prep: ' + recipe.prepTime + 'm'"></span>
                                        <span x-show="recipe.cookTime > 0" x-text="' | Cook: ' + recipe.cookTime + 'm'"></span>
                                        <span x-text="' | ' + recipe.difficulty"></span>
                                    </div>
                                    <div x-show="recipe.tags && recipe.tags.length > 0" class="mt-2">
                                        <template x-for="tag in (recipe.tags || [])" :key="tag">
                                            <span class="inline-block bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded mr-1 mb-1" x-text="tag"></span>
                                        </template>
                                    </div>
                                </div>
                            </template>
                            
                            <template x-if="getFilteredRecipes().length === 0">
                                <div class="text-center text-gray-500 py-8">
                                    <i class="fas fa-search text-2xl mb-2"></i>
                                    <p x-text="'No recipes found matching your criteria'"></p>
                                </div>
                            </template>
                        </div>
                    </div>
                </div>
                
                <!-- Recipe Form/Details -->
                <div class="lg:col-span-2">
                    <div x-show="showRecipeForm" class="bg-gray-50 rounded-lg p-6">
                        <h3 class="font-bold mb-4" x-text="editingRecipe ? translations.editRecipe : translations.addRecipe"></h3>
                        
                        <form @submit.prevent="saveRecipe">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                                <div>
                                    <label class="block text-sm font-medium mb-1" x-text="translations.recipeName"></label>
                                    <input type="text" x-model="recipeForm.name" required
                                           class="w-full border rounded-lg px-3 py-2">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium mb-1" x-text="translations.category"></label>
                                    <select x-model="recipeForm.category" required class="w-full border rounded-lg px-3 py-2">
                                        <option value="">Select Category</option>
                                        <template x-for="category in recipeCategories" :key="category">
                                            <option :value="category" x-text="category"></option>
                                        </template>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium mb-1" x-text="translations.price"></label>
                                    <input type="number" x-model="recipeForm.price" step="0.01" min="0" required
                                           class="w-full border rounded-lg px-3 py-2">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium mb-1" x-text="translations.basePortions"></label>
                                    <input type="number" x-model="recipeForm.basePortions" min="1" required
                                           class="w-full border rounded-lg px-3 py-2">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium mb-1">Prep Time (minutes)</label>
                                    <input type="number" x-model="recipeForm.prepTime" min="0" required
                                           class="w-full border rounded-lg px-3 py-2">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium mb-1">Cook Time (minutes)</label>
                                    <input type="number" x-model="recipeForm.cookTime" min="0" required
                                           class="w-full border rounded-lg px-3 py-2">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium mb-1">Difficulty</label>
                                    <select x-model="recipeForm.difficulty" class="w-full border rounded-lg px-3 py-2">
                                        <option value="easy">Easy</option>
                                        <option value="medium">Medium</option>
                                        <option value="hard">Hard</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium mb-1">Active</label>
                                    <div class="flex items-center mt-2">
                                        <input type="checkbox" x-model="recipeForm.isActive" class="mr-2">
                                        <span class="text-sm">Available for ordering</span>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="mb-4">
                                <label class="block text-sm font-medium mb-1" x-text="translations.ingredients"></label>
                                <div class="space-y-2">
                                    <template x-for="(ingredient, index) in recipeForm.ingredients" :key="index">
                                        <div class="grid grid-cols-12 gap-2">
                                            <input type="text" x-model="ingredient.name" placeholder="Ingredient"
                                                   class="col-span-5 border rounded-lg px-3 py-2">
                                            <input type="number" x-model="ingredient.quantity" step="0.01" min="0" placeholder="Qty"
                                                   class="col-span-2 border rounded-lg px-3 py-2">
                                            <input type="text" x-model="ingredient.unit" placeholder="Unit"
                                                   class="col-span-2 border rounded-lg px-3 py-2">
                                            <input type="text" x-model="ingredient.notes" placeholder="Notes"
                                                   class="col-span-2 border rounded-lg px-3 py-2">
                                            <button type="button" @click="recipeForm.ingredients.splice(index, 1)"
                                                    class="col-span-1 text-red-500 hover:text-red-700">
                                                <i class="fas fa-times"></i>
                                            </button>
                                        </div>
                                    </template>
                                </div>
                                <button type="button" @click="recipeForm.ingredients.push({name: '', quantity: 0, unit: '', notes: ''})"
                                        class="mt-2 text-sm text-primary">
                                    <i class="fas fa-plus mr-1"></i>
                                    <span x-text="translations.addIngredient"></span>
                                </button>
                            </div>
                            
                            <div class="mb-4">
                                <label class="block text-sm font-medium mb-1">Tags (comma-separated)</label>
                                <input type="text" x-model="(recipeForm.tags || []).join(', ')" placeholder="vegetarian, spicy, gluten-free"
                                       class="w-full border rounded-lg px-3 py-2"
                                       @input="recipeForm.tags = $event.target.value.split(',').map(tag => tag.trim()).filter(tag => tag)">
                            </div>
                            
                            <div class="mb-6">
                                <label class="block text-sm font-medium mb-1" x-text="translations.instructions"></label>
                                <textarea x-model="recipeForm.instructions" rows="4"
                                          class="w-full border rounded-lg px-3 py-2"></textarea>
                            </div>
                            
                            <div class="mb-4">
                                <label class="block text-sm font-medium mb-1">Notes</label>
                                <textarea x-model="recipeForm.notes" rows="2"
                                          class="w-full border rounded-lg px-3 py-2"></textarea>
                            </div>
                            
                            <div class="flex justify-end gap-3">
                                <button type="button" @click="showRecipeForm = false"
                                        class="border border-gray-300 px-4 py-2 rounded-lg hover:bg-gray-100 transition">
                                    <span x-text="translations.cancel"></span>
                                </button>
                                <button type="submit" class="bg-primary text-white px-4 py-2 rounded-lg hover:bg-teal-700 transition">
                                    <span x-text="translations.saveRecipe"></span>
                                </button>
                            </div>
                        </form>
                    </div>
                    
                    <!-- Enhanced Recipe Details -->
                    <div x-show="!showRecipeForm && selectedRecipe" class="bg-gray-50 rounded-lg p-6">
                        <div class="flex justify-between items-start mb-4">
                            <h3 class="font-bold text-xl" x-text="selectedRecipe?.name || ''"></h3>
                            <div class="flex gap-2">
                                <button @click="editRecipe(selectedRecipe)"
                                        class="bg-blue-500 text-white px-3 py-1 rounded text-sm hover:bg-blue-600 transition">
                                    <i class="fas fa-edit mr-1"></i>Edit
                                </button>
                                <button @click="duplicateRecipe(selectedRecipe)"
                                        class="bg-green-500 text-white px-3 py-1 rounded text-sm hover:bg-green-600 transition">
                                    <i class="fas fa-copy mr-1"></i>Duplicate
                                </button>
                            </div>
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                            <div class="bg-white p-3 rounded-lg">
                                <div class="text-sm text-gray-600">Category</div>
                                <div class="font-bold" x-text="selectedRecipe?.category"></div>
                            </div>
                            <div class="bg-white p-3 rounded-lg">
                                <div class="text-sm text-gray-600">Price</div>
                                <div class="font-bold text-primary" x-text="formatPrice(selectedRecipe?.price || 0)"></div>
                            </div>
                            <div class="bg-white p-3 rounded-lg">
                                <div class="text-sm text-gray-600">Difficulty</div>
                                <div class="font-bold capitalize" x-text="selectedRecipe?.difficulty"></div>
                            </div>
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <h4 class="font-bold mb-3">Ingredients</h4>
                            <div class="bg-white border rounded-lg p-4">
                                    <template x-for="ingredient in (selectedRecipe?.ingredients || [])" :key="ingredient.name">
                                    <div class="flex justify-between py-2 border-b last:border-b-0">
                                        <div>
                                                <div class="font-medium" x-text="ingredient.name || 'Unknown'"></div>
                                                <div x-show="ingredient.notes" class="text-xs text-gray-500" x-text="ingredient.notes"></div>
                                            </div>
                                            <div class="text-right">
                                                <div class="font-bold" x-text="(ingredient.quantity || 0) + ' ' + (ingredient.unit || '')"></div>
                                        </div>
                                    </div>
                                </template>
                            </div>
                        </div>
                        
                        <div>
                                <h4 class="font-bold mb-3">Instructions</h4>
                            <div class="bg-white border rounded-lg p-4 whitespace-pre-line" 
                                     x-text="selectedRecipe?.instructions || 'No instructions available'"></div>
                            </div>
                        </div>
                        
                        <div x-show="selectedRecipe?.tags && selectedRecipe.tags.length > 0" class="mt-4">
                            <h4 class="font-bold mb-2">Tags</h4>
                            <div class="flex flex-wrap gap-2">
                                <template x-for="tag in (selectedRecipe?.tags || [])" :key="tag">
                                    <span class="bg-blue-100 text-blue-800 px-2 py-1 rounded text-sm" x-text="tag"></span>
                                </template>
                            </div>
                        </div>
                        
                        <div x-show="selectedRecipe?.notes" class="mt-4">
                            <h4 class="font-bold mb-2">Notes</h4>
                            <div class="bg-white border rounded-lg p-4" x-text="selectedRecipe?.notes || ''"></div>
                        </div>
                    </div>
                    
                    <div x-show="!showRecipeForm && !selectedRecipe" class="text-center py-12 text-gray-500">
                        <i class="fas fa-book-open text-4xl mb-4"></i>
                        <p x-text="translations.selectRecipe"></p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Table Management -->
        <div x-show="currentTab === 'tables'" class="bg-white rounded-lg shadow-lg p-6">
            <h2 class="text-2xl font-bold mb-6 text-primary flex items-center gap-2">
                <i class="fas fa-chair"></i>
                <span x-text="translations.tableManagement"></span>
            </h2>
            
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                <!-- Table List -->
                <div class="lg:col-span-2">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-lg font-bold" x-text="translations.tables"></h3>
                        <button @click="addTable()"
                                class="bg-primary text-white px-4 py-2 rounded-lg text-sm hover:bg-teal-700 transition">
                            <i class="fas fa-plus mr-1"></i>
                            <span x-text="translations.addTable"></span>
                        </button>
                    </div>
                    
                    <div class="grid grid-cols-2 md:grid-cols-3 gap-4">
                        <template x-for="table in tables" :key="table.id">
                            <div class="bg-gray-50 border rounded-lg p-4 hover:shadow-md transition">
                                <div class="flex justify-between items-start mb-2">
                                    <div>
                                        <div class="font-bold text-lg" x-text="'Table ' + table.number"></div>
                                        <div class="text-sm text-gray-600" x-text="table.capacity + ' seats'"></div>
                                        <div x-show="table.location" class="text-xs text-gray-500" x-text="table.location"></div>
                                        <div x-show="table.notes" class="text-xs text-gray-500 italic" x-text="table.notes"></div>
                                    </div>
                                    <div class="px-2 py-1 rounded-full text-xs" 
                                         :class="getTableStatusColor(table.status)"
                                         x-text="translations[table.status]"></div>
                                </div>
                                
                                <!-- Table Stats -->
                                <div class="mt-2 space-y-1 text-xs text-gray-600">
                                    <div class="flex justify-between">
                                        <span x-text="translations.revenue"></span>
                                        <span x-text="formatPrice(getTableRevenue(table.number))"></span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span x-text="translations.averageOrderValue"></span>
                                        <span x-text="formatPrice(getTableAverageOrder(table.number))"></span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span x-text="translations.occupancyTime"></span>
                                        <span x-text="getTableOccupancyTime(table.number) + ' min'"></span>
                                    </div>
                                </div>
                                
                                <div class="mt-3 space-y-2">
                                    <div class="flex gap-1">
                                        <button @click="editTable(table)"
                                                class="flex-1 bg-blue-500 text-white px-2 py-1 rounded text-xs hover:bg-blue-600 transition">
                                            <i class="fas fa-edit"></i>
                                        </button>
                                        <button @click="selectedTable = table.number"
                                                class="flex-1 bg-green-500 text-white px-2 py-1 rounded text-xs hover:bg-green-600 transition">
                                            <i class="fas fa-eye"></i>
                                        </button>
                                        <button @click="deleteTable(table.id)"
                                                class="flex-1 bg-red-500 text-white px-2 py-1 rounded text-xs hover:bg-red-600 transition">
                                            <i class="fas fa-trash"></i>
                                        </button>
                                    </div>
                                    
                                    <div class="flex gap-1">
                                        <button x-show="table.status === 'available'" 
                                                @click="makeReservation(table.id)"
                                                class="flex-1 bg-yellow-500 text-white px-2 py-1 rounded text-xs hover:bg-yellow-600 transition">
                                            <i class="fas fa-calendar mr-1"></i>
                                            <span x-text="translations.makeReservation"></span>
                                        </button>
                                        <button x-show="table.status === 'reserved'" 
                                                @click="cancelReservation(table.id)"
                                                class="flex-1 bg-gray-500 text-white px-2 py-1 rounded text-xs hover:bg-gray-600 transition">
                                            <i class="fas fa-times mr-1"></i>
                                            <span x-text="translations.cancelReservation"></span>
                                        </button>
                                        <button x-show="table.status === 'occupied'" 
                                                @click="closeTable(table.number)"
                                                class="flex-1 bg-red-500 text-white px-2 py-1 rounded text-xs hover:bg-red-600 transition">
                                            <i class="fas fa-times mr-1"></i>
                                            <span x-text="translations.closeTable"></span>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </template>
                    </div>
                </div>
                
                <!-- Table Orders -->
                <div>
                    <div x-show="selectedTable" class="bg-gray-50 rounded-lg p-4">
                        <h3 class="font-bold mb-4" x-text="'Table ' + selectedTable + ' - ' + translations.tableOrders"></h3>
                        
                        <div class="space-y-3">
                            <template x-for="order in getTableOrders(selectedTable)" :key="order.id">
                                <div class="bg-white border rounded-lg p-3">
                                    <div class="flex justify-between items-start mb-2">
                                        <div>
                                            <div class="font-bold" x-text="'Order #' + order.id"></div>
                                            <div class="text-sm text-gray-600" x-text="formatDateTime(order.timestamp)"></div>
                                        </div>
                                        <div class="px-2 py-1 rounded-full text-xs" 
                                             :class="{
                                                 'bg-blue-100 text-blue-800': order.status === 'new',
                                                 'bg-orange-100 text-orange-800': order.status === 'preparing',
                                                 'bg-green-100 text-green-800': order.status === 'ready'
                                             }"
                                             x-text="translations[order.status]"></div>
                                    </div>
                                    
                                    <div class="border-t pt-2">
                                        <template x-for="item in order.items" :key="item.id">
                                            <div class="flex justify-between text-sm py-1">
                                                <div>
                                                    <span x-text="item.quantity + '×'"></span>
                                                    <span x-text="item.name"></span>
                                                </div>
                                                <div x-text="formatPrice(item.price * item.quantity)"></div>
                                            </div>
                                        </template>
                                    </div>
                                    
                                    <div class="mt-3 pt-2 border-t">
                                        <div class="flex justify-between text-sm">
                                            <span x-text="translations.total"></span>
                                            <span class="font-bold" x-text="formatPrice(order.total)"></span>
                                        </div>
                                    </div>
                                </div>
                            </template>
                            
                            <template x-if="getTableOrders(selectedTable).length === 0">
                                <div class="text-center text-gray-500 py-8">
                                    <i class="fas fa-utensils text-2xl mb-2"></i>
                                    <p x-text="translations.noNewOrders"></p>
                                </div>
                            </template>
                        </div>
                    </div>
                    
                    <div x-show="!selectedTable" class="text-center py-12 text-gray-500">
                        <i class="fas fa-chair text-4xl mb-4"></i>
                        <p x-text="translations.selectTable"></p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Reports Section -->
        <div x-show="currentTab === 'reports'" class="bg-white rounded-lg shadow-lg p-6">
            <h2 class="text-2xl font-bold mb-6 text-primary flex items-center gap-2">
                <i class="fas fa-chart-bar"></i>
                <span x-text="translations.salesReport"></span>
            </h2>
            
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <!-- Daily Report -->
                <div class="bg-gray-50 rounded-lg p-4">
                    <h3 class="font-bold mb-4" x-text="translations.dailyReport"></h3>
                    <div class="space-y-2">
                        <div class="flex justify-between">
                            <span x-text="translations.totalSales"></span>
                            <span class="font-bold" x-text="formatPrice(reports.dailySales.totalSales || 0)"></span>
                        </div>
                        <div class="flex justify-between">
                            <span x-text="translations.totalOrders"></span>
                            <span class="font-bold" x-text="reports.dailySales.totalOrders || 0"></span>
                        </div>
                        <div class="flex justify-between">
                            <span x-text="translations.completedOrders"></span>
                            <span class="font-bold" x-text="reports.dailySales.completedOrders || 0"></span>
                        </div>
                        <div class="flex justify-between">
                            <span x-text="translations.averageOrder"></span>
                            <span class="font-bold" x-text="formatPrice(reports.dailySales.averageOrder || 0)"></span>
                        </div>
                        <div class="flex justify-between">
                            <span>Net Sales</span>
                            <span class="font-bold" x-text="formatPrice(reports.dailySales.netSales || 0)"></span>
                        </div>
                        <div class="flex justify-between">
                            <span>Completion Rate</span>
                            <span class="font-bold" x-text="Math.round(reports.dailySales.completionRate || 0) + '%'"></span>
                        </div>
                    </div>
                </div>
                
                <!-- Monthly Report -->
                <div class="bg-gray-50 rounded-lg p-4">
                    <h3 class="font-bold mb-4" x-text="translations.monthlyReport"></h3>
                    <div class="space-y-2">
                        <div class="flex justify-between">
                            <span x-text="translations.totalSales"></span>
                            <span class="font-bold" x-text="formatPrice(reports.monthlySales.totalSales || 0)"></span>
                        </div>
                        <div class="flex justify-between">
                            <span x-text="translations.totalOrders"></span>
                            <span class="font-bold" x-text="reports.monthlySales.totalOrders || 0"></span>
                        </div>
                        <div class="flex justify-between">
                            <span x-text="translations.completedOrders"></span>
                            <span class="font-bold" x-text="reports.monthlySales.completedOrders || 0"></span>
                        </div>
                        <div class="flex justify-between">
                            <span x-text="translations.averageOrder"></span>
                            <span class="font-bold" x-text="formatPrice(reports.monthlySales.averageOrder || 0)"></span>
                        </div>
                        <div class="flex justify-between">
                            <span>Net Sales</span>
                            <span class="font-bold" x-text="formatPrice(reports.monthlySales.netSales || 0)"></span>
                        </div>
                        <div class="flex justify-between">
                            <span>Avg Daily Sales</span>
                            <span class="font-bold" x-text="formatPrice(reports.monthlySales.averageDailySales || 0)"></span>
                        </div>
                    </div>
                </div>
                
                <!-- Top Items -->
                <div class="bg-gray-50 rounded-lg p-4">
                    <h3 class="font-bold mb-4" x-text="translations.topItems"></h3>
                    <div class="space-y-2">
                        <template x-for="(item, index) in reports.topItems" :key="index">
                            <div class="bg-white p-2 rounded border">
                                <div class="flex justify-between items-center mb-1">
                                    <span class="font-medium" x-text="(index + 1) + '. ' + item.name"></span>
                                    <span class="font-bold text-primary" x-text="item.quantity + ' sold'"></span>
                                </div>
                                <div class="flex justify-between text-sm text-gray-600">
                                    <span x-text="'Revenue: ' + formatPrice(item.revenue)"></span>
                                    <span x-text="'Avg: ' + formatPrice(item.averagePrice)"></span>
                                </div>
                            </div>
                        </template>
                        <template x-if="reports.topItems.length === 0">
                            <div class="text-center text-gray-500 py-4" x-text="translations.noNewOrders"></div>
                        </template>
                    </div>
                </div>
                
                <!-- Category Report -->
                <div class="bg-gray-50 rounded-lg p-4">
                    <h3 class="font-bold mb-4" x-text="translations.categoryReport"></h3>
                    <div class="space-y-2">
                        <template x-for="(category, index) in reports.categorySales" :key="index">
                            <div class="bg-white p-2 rounded border">
                                <div class="flex justify-between items-center mb-1">
                                    <span class="font-medium" x-text="category.category"></span>
                                    <span class="font-bold text-primary" x-text="formatPrice(category.sales)"></span>
                                </div>
                                <div class="flex justify-between text-sm text-gray-600">
                                    <span x-text="category.quantity + ' items'"></span>
                                    <span x-text="'Avg: ' + formatPrice(category.averageOrderValue)"></span>
                                </div>
                            </div>
                        </template>
                        <template x-if="reports.categorySales.length === 0">
                            <div class="text-center text-gray-500 py-4" x-text="translations.noNewOrders"></div>
                        </template>
                    </div>
                </div>
                
                <!-- Order Type Report -->
                <div class="bg-gray-50 rounded-lg p-4">
                    <h3 class="font-bold mb-4">Order Type Analysis</h3>
                    <div class="space-y-2">
                        <template x-for="(type, index) in reports.orderTypeSales" :key="index">
                            <div class="bg-white p-2 rounded border">
                                <div class="flex justify-between items-center mb-1">
                                    <span class="font-medium capitalize" x-text="type.type"></span>
                                    <span class="font-bold text-primary" x-text="formatPrice(type.sales)"></span>
                                </div>
                                <div class="flex justify-between text-sm text-gray-600">
                                    <span x-text="type.orders + ' orders'"></span>
                                    <span x-text="'Avg: ' + formatPrice(type.averageOrder)"></span>
                                </div>
                            </div>
                        </template>
                        <template x-if="!reports.orderTypeSales || reports.orderTypeSales.length === 0">
                            <div class="text-center text-gray-500 py-4">No order type data available</div>
                        </template>
                    </div>
                </div>
                
                <!-- Hourly Report -->
                <div class="bg-gray-50 rounded-lg p-4">
                    <h3 class="font-bold mb-4">Peak Hours Analysis</h3>
                    <div class="space-y-2">
                        <template x-for="(hour, index) in reports.hourlySales" :key="index">
                            <div class="bg-white p-2 rounded border">
                                <div class="flex justify-between items-center mb-1">
                                    <span class="font-medium" x-text="hour.hour + ':00'"></span>
                                    <span class="font-bold text-primary" x-text="formatPrice(hour.sales)"></span>
                                </div>
                                <div class="flex justify-between text-sm text-gray-600">
                                    <span x-text="hour.orders + ' orders'"></span>
                                    <span x-text="'Avg: ' + formatPrice(hour.averageOrder)"></span>
                                </div>
                            </div>
                        </template>
                        <template x-if="!reports.hourlySales || reports.hourlySales.length === 0">
                            <div class="text-center text-gray-500 py-4">No hourly data available</div>
                        </template>
                    </div>
                </div>
            </div>
            
            <div class="mt-6 flex justify-center gap-4">
                <button @click="exportData()" 
                        class="bg-primary text-white px-6 py-3 rounded-lg hover:bg-teal-700 transition">
                    <i class="fas fa-download mr-2"></i>
                    <span x-text="translations.exportData"></span>
                </button>
                <button @click="generateReports()" 
                        class="bg-green-500 text-white px-6 py-3 rounded-lg hover:bg-green-600 transition">
                    <i class="fas fa-sync mr-2"></i>
                    Refresh Reports
                </button>
            </div>
        </div>
    </main>

    <!-- Settings Modal -->
    <div x-show="showSettings" 
         class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"
         @click="showSettings = false">
        <div class="bg-white rounded-lg p-6 w-full max-w-2xl mx-4 max-h-screen overflow-y-auto" @click.stop>
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-lg font-bold" x-text="translations.settings"></h3>
                <button @click="showSettings = false" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <form @submit.prevent="saveSettings(); showSettings = false">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <!-- Restaurant Information -->
                    <div>
                        <h4 class="font-bold mb-3" x-text="translations.restaurantInfo"></h4>
                        <div class="space-y-3">
                            <div>
                                <label class="block text-sm font-medium mb-1" x-text="translations.restaurantName"></label>
                                <input type="text" x-model="settings.restaurantName" required
                                       class="w-full border rounded-lg px-3 py-2">
                            </div>
                            <div>
                                <label class="block text-sm font-medium mb-1" x-text="translations.address"></label>
                                <textarea x-model="settings.address" rows="2"
                                          class="w-full border rounded-lg px-3 py-2"></textarea>
                            </div>
                            <div>
                                <label class="block text-sm font-medium mb-1" x-text="translations.phone"></label>
                                <input type="text" x-model="settings.phone"
                                       class="w-full border rounded-lg px-3 py-2">
                            </div>
                            <div>
                                <label class="block text-sm font-medium mb-1" x-text="translations.email"></label>
                                <input type="email" x-model="settings.email"
                                       class="w-full border rounded-lg px-3 py-2">
                            </div>
                            <div>
                                <label class="block text-sm font-medium mb-1" x-text="translations.website"></label>
                                <input type="text" x-model="settings.website"
                                       class="w-full border rounded-lg px-3 py-2">
                            </div>
                        </div>
                    </div>
                    
                    <!-- Receipt Settings -->
                    <div>
                        <h4 class="font-bold mb-3" x-text="translations.receiptSettings"></h4>
                        <div class="space-y-3">
                            <div>
                                <label class="block text-sm font-medium mb-1" x-text="translations.taxRate"></label>
                                <input type="number" x-model="settings.taxRate" min="0" max="100" step="0.1" required
                                       class="w-full border rounded-lg px-3 py-2">
                            </div>
                            <div>
                                <label class="block text-sm font-medium mb-1" x-text="translations.deliveryFee"></label>
                                <input type="number" x-model="settings.deliveryFee" min="0" step="0.01" required
                                       class="w-full border rounded-lg px-3 py-2">
                            </div>
                            <div>
                                <label class="block text-sm font-medium mb-1" x-text="translations.currency"></label>
                                <select x-model="settings.currency" class="w-full border rounded-lg px-3 py-2">
                                    <option value="USD">USD ($)</option>
                                    <option value="EUR">EUR (€)</option>
                                    <option value="GBP">GBP (£)</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium mb-1" x-text="translations.receiptFooter"></label>
                                <textarea x-model="settings.receiptFooter" rows="2"
                                          class="w-full border rounded-lg px-3 py-2"></textarea>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Print Settings -->
                    <div>
                        <h4 class="font-bold mb-3" x-text="translations.printSettings"></h4>
                        <div class="space-y-3">
                            <div class="flex items-center">
                                <input type="checkbox" x-model="settings.printHeader" id="printHeader"
                                       class="mr-2">
                                <label for="printHeader" class="text-sm" x-text="translations.printHeader"></label>
                            </div>
                            <div class="flex items-center">
                                <input type="checkbox" x-model="settings.printFooter" id="printFooter"
                                       class="mr-2">
                                <label for="printFooter" class="text-sm" x-text="translations.printFooter"></label>
                            </div>
                            <div class="flex items-center">
                                <input type="checkbox" x-model="settings.autoPrint" id="autoPrint"
                                       class="mr-2">
                                <label for="autoPrint" class="text-sm" x-text="translations.autoPrint"></label>
                            </div>
                            <div>
                                <label class="block text-sm font-medium mb-1" x-text="translations.receiptWidth"></label>
                                <input type="number" x-model="settings.receiptWidth" min="50" max="120" step="1"
                                       class="w-full border rounded-lg px-3 py-2">
                            </div>
                            <div>
                                <label class="block text-sm font-medium mb-1" x-text="translations.fontSize"></label>
                                <input type="number" x-model="settings.fontSize" min="8" max="16" step="1"
                                       class="w-full border rounded-lg px-3 py-2">
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="flex justify-end gap-3 mt-6">
                    <button type="button" @click="showSettings = false"
                            class="border border-gray-300 px-4 py-2 rounded-lg hover:bg-gray-100 transition">
                        <span x-text="translations.cancel"></span>
                    </button>
                    <button type="submit" class="bg-primary text-white px-4 py-2 rounded-lg hover:bg-teal-700 transition">
                        <span x-text="translations.saveSettings"></span>
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Receipt Modal -->
    <div x-show="showReceipt" 
         class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"
         @click="showReceipt = false">
        <div class="bg-white rounded-lg p-6 w-full max-w-md mx-4 max-h-screen overflow-y-auto" @click.stop>
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-lg font-bold" x-text="translations.receipt"></h3>
                <button @click="showReceipt = false" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="receipt-preview mb-4 p-4 border rounded-lg bg-gray-50" 
                 style="font-family: 'Courier New', monospace; font-size: 12px;">
                <div x-html="generateReceiptHTML()"></div>
            </div>
            
            <div class="flex justify-end gap-3">
                <button @click="showReceipt = false"
                        class="border border-gray-300 px-4 py-2 rounded-lg hover:bg-gray-100 transition">
                    <span x-text="translations.cancel"></span>
                </button>
                <button @click="printReceipt()" 
                        class="bg-primary text-white px-4 py-2 rounded-lg hover:bg-teal-700 transition">
                    <i class="fas fa-print mr-2"></i>
                    <span x-text="translations.print"></span>
                </button>
            </div>
        </div>
    </div>

    <!-- Table Form Modal -->
    <div x-show="showTableForm" 
         class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"
         @click="showTableForm = false">
        <div class="bg-white rounded-lg p-6 w-full max-w-md mx-4" @click.stop>
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-lg font-bold" x-text="editingTable ? translations.editTable : translations.addTable"></h3>
                <button @click="showTableForm = false" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <form @submit.prevent="saveTable()">
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium mb-1" x-text="translations.tableNumber"></label>
                        <input type="number" x-model="tableForm.number" min="1" required
                               class="w-full border rounded-lg px-3 py-2">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium mb-1" x-text="translations.capacity"></label>
                        <input type="number" x-model="tableForm.capacity" min="1" max="20" required
                               class="w-full border rounded-lg px-3 py-2">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium mb-1" x-text="translations.location"></label>
                        <input type="text" x-model="tableForm.location" placeholder="e.g., Window, Patio, Bar"
                               class="w-full border rounded-lg px-3 py-2">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium mb-1" x-text="translations.tableStatus"></label>
                        <select x-model="tableForm.status" class="w-full border rounded-lg px-3 py-2">
                            <option value="available" x-text="translations.available"></option>
                            <option value="reserved" x-text="translations.reserved"></option>
                            <option value="occupied" x-text="translations.occupied"></option>
                            <option value="cleaning" x-text="translations.cleaning"></option>
                            <option value="maintenance" x-text="translations.maintenance"></option>
                        </select>
                    </div>
                    
                    <div x-show="tableForm.status === 'reserved'">
                        <label class="block text-sm font-medium mb-1" x-text="translations.customerName"></label>
                        <input type="text" x-model="tableForm.customerName" placeholder="Customer name"
                               class="w-full border rounded-lg px-3 py-2">
                    </div>
                    
                    <div x-show="tableForm.status === 'reserved'">
                        <label class="block text-sm font-medium mb-1" x-text="translations.customerPhone"></label>
                        <input type="text" x-model="tableForm.customerPhone" placeholder="Customer phone"
                               class="w-full border rounded-lg px-3 py-2">
                    </div>
                    
                    <div x-show="tableForm.status === 'reserved'">
                        <label class="block text-sm font-medium mb-1" x-text="translations.reservationTime"></label>
                        <input type="datetime-local" x-model="tableForm.reservationTime"
                               class="w-full border rounded-lg px-3 py-2">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium mb-1" x-text="translations.notes"></label>
                        <textarea x-model="tableForm.notes" rows="3" placeholder="Additional notes about the table"
                                  class="w-full border rounded-lg px-3 py-2"></textarea>
                    </div>
                </div>
                
                <div class="flex justify-end gap-3 mt-6">
                    <button type="button" @click="showTableForm = false"
                            class="border border-gray-300 px-4 py-2 rounded-lg hover:bg-gray-100 transition">
                        <span x-text="translations.cancel"></span>
                    </button>
                    <button type="submit" class="bg-primary text-white px-4 py-2 rounded-lg hover:bg-teal-700 transition">
                        <span x-text="translations.saveRecipe"></span>
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Enhanced Backup Modal -->
    <div x-show="showBackup" 
         class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"
         @click="showBackup = false">
        <div class="bg-white rounded-lg p-6 w-full max-w-md mx-4" @click.stop>
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-lg font-bold" x-text="translations.backup"></h3>
                <button @click="showBackup = false" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="space-y-4">
                <div>
                    <h4 class="font-bold mb-2" x-text="translations.exportBackup"></h4>
                    <p class="text-sm text-gray-600 mb-3">Export all data including recipes, orders, tables, settings, chefs, and stations.</p>
                    <button @click="exportAllData()" 
                            class="w-full bg-green-500 text-white px-4 py-2 rounded-lg hover:bg-green-600 transition">
                        <i class="fas fa-download mr-2"></i>
                        <span x-text="translations.exportBackup"></span>
                    </button>
                </div>
                
                <div class="border-t pt-4">
                    <h4 class="font-bold mb-2" x-text="translations.importBackup"></h4>
                    <p class="text-sm text-gray-600 mb-3">Import backup file to restore all data. This will replace current data.</p>
                    <input type="file" @change="importBackupFile($event)" accept=".json"
                           class="w-full border rounded-lg px-3 py-2">
                </div>
                
                <div class="border-t pt-4">
                    <h4 class="font-bold mb-2">Data Management</h4>
                    <div class="space-y-2">
                        <button @click="validateAndCleanData(); alert('Data cleaned successfully!')" 
                                class="w-full bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition">
                            <i class="fas fa-broom mr-2"></i>
                            Clean & Validate Data
                        </button>
                        <button @click="clearAllData()" 
                                class="w-full bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600 transition">
                            <i class="fas fa-trash mr-2"></i>
                            Clear All Data
                        </button>
                    </div>
                </div>
            </div>
            
            <div class="flex justify-end mt-6">
                <button @click="showBackup = false"
                        class="border border-gray-300 px-4 py-2 rounded-lg hover:bg-gray-100 transition">
                    <span x-text="translations.cancel"></span>
                </button>
            </div>
        </div>
    </div>

    <!-- KDS Settings Modal -->
    <div x-show="showKdsSettings" 
         class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"
         @click="showKdsSettings = false">
        <div class="bg-white rounded-lg p-6 w-full max-w-md mx-4" @click.stop>
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-lg font-bold" x-text="translations.kdsSettings"></h3>
                <button @click="showKdsSettings = false" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="space-y-4">
                <div>
                    <label class="block text-sm font-medium mb-1" x-text="translations.kdsRefreshInterval"></label>
                    <input type="number" x-model="kdsRefreshInterval" min="5" max="300" step="5"
                           class="w-full border rounded-lg px-3 py-2">
                </div>
                
                <div class="flex items-center">
                    <input type="checkbox" x-model="kdsAutoRefresh" id="kdsAutoRefresh"
                           class="mr-2">
                    <label for="kdsAutoRefresh" class="text-sm" x-text="translations.kdsAutoRefresh"></label>
                </div>
                
                <div class="flex items-center">
                    <input type="checkbox" x-model="kdsSoundEnabled" id="kdsSoundEnabled"
                           class="mr-2">
                    <label for="kdsSoundEnabled" class="text-sm" x-text="translations.kdsSoundEnabled"></label>
                </div>
                
                <div class="flex items-center">
                    <input type="checkbox" x-model="kdsNotifications" id="kdsNotifications"
                           class="mr-2">
                    <label for="kdsNotifications" class="text-sm" x-text="translations.kdsNotifications"></label>
                </div>
            </div>
            
            <div class="flex justify-end gap-3 mt-6">
                <button @click="showKdsSettings = false"
                        class="border border-gray-300 px-4 py-2 rounded-lg hover:bg-gray-100 transition">
                    <span x-text="translations.cancel"></span>
                </button>
                <button @click="showKdsSettings = false; startKdsAutoRefresh()" 
                        class="bg-primary text-white px-4 py-2 rounded-lg hover:bg-teal-700 transition">
                    <span x-text="translations.saveSettings"></span>
                </button>
            </div>
        </div>
    </div>

    <!-- Chef Assignment Modal -->
    <div x-show="showChefAssignModal" 
         class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"
         @click="showChefAssignModal = false">
        <div class="bg-white rounded-lg p-6 w-full max-w-md mx-4" @click.stop>
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-lg font-bold" x-text="translations.kdsAssignChef"></h3>
                <button @click="showChefAssignModal = false" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form @submit.prevent="assignOrderToChefStation(chefAssignOrderId, chefAssignName, chefAssignStation)">
                <div class="mb-4">
                    <label class="block text-sm font-medium mb-1" x-text="translations.kdsSelectChef"></label>
                    <select x-model="chefAssignName" class="w-full border rounded-lg px-3 py-2" required>
                        <option value="" disabled selected>Select</option>
                        <template x-for="chef in chefs" :key="chef.name">
                            <option :value="chef.name" x-text="chef.name"></option>
                        </template>
                    </select>
                </div>
                <div class="mb-4">
                    <label class="block text-sm font-medium mb-1" x-text="translations.kdsSelectStation"></label>
                    <select x-model="chefAssignStation" class="w-full border rounded-lg px-3 py-2" required>
                        <option value="" disabled selected>Select</option>
                        <template x-for="station in stations" :key="station.name">
                            <option :value="station.name" x-text="station.name"></option>
                        </template>
                    </select>
                </div>
                <div class="flex justify-end gap-3 mt-6">
                    <button type="button" @click="showChefAssignModal = false"
                            class="border border-gray-300 px-4 py-2 rounded-lg hover:bg-gray-100 transition">
                        <span x-text="translations.cancel"></span>
                    </button>
                    <button type="submit" class="bg-primary text-white px-4 py-2 rounded-lg hover:bg-teal-700 transition">
                        <span x-text="translations.kdsSave"></span>
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Chef/Station Management Modal -->
    <div x-show="showChefStationManager" 
         class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"
         @click="showChefStationManager = false">
        <div class="bg-white rounded-lg p-6 w-full max-w-2xl mx-4 max-h-screen overflow-y-auto" @click.stop>
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-lg font-bold" x-text="translations.kdsManageChefs"></h3>
                <button @click="showChefStationManager = false" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div>
                <div class="flex gap-4 mb-6">
                    <button @click="chefStationTab = 'chefs'" :class="{'bg-primary text-white': chefStationTab === 'chefs', 'bg-gray-100': chefStationTab !== 'chefs'}" class="px-4 py-2 rounded-lg font-bold">
                        <span x-text="translations.kdsManageChefs"></span>
                    </button>
                    <button @click="chefStationTab = 'stations'" :class="{'bg-primary text-white': chefStationTab === 'stations', 'bg-gray-100': chefStationTab !== 'stations'}" class="px-4 py-2 rounded-lg font-bold">
                        <span x-text="translations.kdsManageStations"></span>
                    </button>
                </div>
                <!-- Chefs Tab -->
                <div x-show="chefStationTab === 'chefs'">
                    <div class="mb-4 flex gap-2">
                        <input type="text" x-model="newChefName" placeholder="Add chef..." class="border rounded-lg px-3 py-2 flex-1">
                        <button @click="addChef()" class="bg-primary text-white px-4 py-2 rounded-lg hover:bg-teal-700 transition" x-text="translations.kdsAddChef"></button>
                    </div>
                    <ul>
                        <template x-for="(chef, idx) in chefs" :key="chef.name">
                            <li class="flex items-center gap-2 mb-2">
                                <input type="text" x-model="chef.name" class="border rounded-lg px-3 py-1 flex-1">
                                <button @click="removeChef(idx)" class="text-red-500 hover:text-red-700"><i class="fas fa-trash"></i></button>
                            </li>
                        </template>
                    </ul>
                </div>
                <!-- Stations Tab -->
                <div x-show="chefStationTab === 'stations'">
                    <div class="mb-4 flex gap-2">
                        <input type="text" x-model="newStationName" placeholder="Add station..." class="border rounded-lg px-3 py-2 flex-1">
                        <button @click="addStation()" class="bg-primary text-white px-4 py-2 rounded-lg hover:bg-teal-700 transition" x-text="translations.kdsAddStation"></button>
                    </div>
                    <ul>
                        <template x-for="(station, idx) in stations" :key="station.name">
                            <li class="flex items-center gap-2 mb-2">
                                <input type="text" x-model="station.name" class="border rounded-lg px-3 py-1 flex-1">
                                <button @click="removeStation(idx)" class="text-red-500 hover:text-red-700"><i class="fas fa-trash"></i></button>
                            </li>
                        </template>
                    </ul>
                </div>
            </div>
            <div class="flex justify-end gap-3 mt-6">
                <button @click="showChefStationManager = false"
                        class="border border-gray-300 px-4 py-2 rounded-lg hover:bg-gray-100 transition">
                    <span x-text="translations.cancel"></span>
                </button>
            </div>
        </div>
    </div>

        <!-- Audio element for new order notification -->
    <audio id="newOrderSound" preload="auto">
        <source src="https://assets.mixkit.co/sfx/preview/mixkit-alarm-digital-clock-beep-989.mp3" type="audio/mpeg">
    </audio>
</body>
</html>